{% extends "base.html" %}

{% block title %}é“¾æ¥ç®¡ç†é¢æ¿{% endblock %}

{% block content %}
    <h1>ğŸ”—çŸ­é“¾æ¥ç®¡ç†</h1>

    <h3>æ–°å»ºçŸ­é“¾æ¥</h3>
    <form method="POST" action="{{ url_for('create_link') }}">
        <label for="original_url">åŸå§‹é“¾æ¥ (å¿…å¡«):</label>
        <input type="url" id="original_url" name="original_url" size="60" required><br><br>
        
        <label for="custom_code">è‡ªå®šä¹‰çŸ­ç  (å¯é€‰):</label>
        <input type="text" id="custom_code" name="custom_code" pattern="[a-zA-Z0-9_-]+" title="åªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿å’ŒçŸ­æ¨ªçº¿"><br><br>
        
        <label for="note">å¤‡æ³¨ (å¯é€‰):</label>
        <input type="text" id="note" name="note" size="40"><br><br>

        <label for="mode">é“¾æ¥æ¨¡å¼:</label>
        <select id="mode" name="mode" required>
            <option value="redirect">è·³è½¬æ¨¡å¼</option>
            <option value="proxy">ä»£ç†æ¨¡å¼</option>
        </select><br>
        <fieldset>
            <legend>æ¨¡å¼è¯´æ˜</legend>
            ğŸ¦˜è·³è½¬æ¨¡å¼ï¼šçŸ­é“¾æ¥å°†ç›´æ¥è·³è½¬åˆ°åŸå§‹é“¾æ¥ï¼Œä¼˜ç‚¹æ˜¯é€Ÿåº¦å¿«ï¼Œç¼ºç‚¹æ˜¯å¯èƒ½æš´éœ²åŸå§‹é“¾æ¥ã€‚<br>
            ğŸ¢ä»£ç†æ¨¡å¼ï¼šçŸ­é“¾æ¥é€šè¿‡æœåŠ¡å™¨ä»£ç†è®¿é—®åŸå§‹é“¾æ¥ï¼Œä¼˜ç‚¹æ˜¯éšè—äº†åŸå§‹é“¾æ¥ï¼Œç¼ºç‚¹æ˜¯å¯èƒ½ç¨æ…¢ã€‚<br>
        </fieldset><br>
        <button type="submit">â•åˆ›å»ºé“¾æ¥</button>
    </form>

    <hr>

    <h3>ç°æœ‰é“¾æ¥åˆ—è¡¨ (å…± {{ links|length }} æ¡)</h3>
    <table>
        <thead>
            <tr>
                <th>çŸ­ç </th>
                <th>é•¿é“¾æ¥</th>
                <th>æ¨¡å¼</th>
                <th>å¤‡æ³¨</th>
                <th>ç‚¹å‡»é‡</th>
                <th>åˆ›å»ºæ—¶é—´</th>
		<th>æ“ä½œ</th>
                </tr>
        </thead>
        <tbody>
            {% for link in links %}
            <tr>
                <td>
                    <a href="https://istill.live/{{ link.short_code }}" target="_blank">
                        {{ link.short_code }}
                    </a>
                </td>
                <td title="{{ link.original_url }}">{{ link.original_url[:50] }}...</td>
                <td>
                    {% if link.mode == 'redirect' %}
                        è·³è½¬æ¨¡å¼
                    {% else %}
                        ä»£ç†æ¨¡å¼
                    {% endif %}
                </td>
                <td>{{ link.note }}</td>
                <td>{{ link.clicks }}</td>
                <td>{{ link.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
                <td>
                <a href="{{ url_for('edit_link', short_code=link.short_code) }}">ç¼–è¾‘</a>

                 |
   
                 <form method="POST" action="{{ url_for('delete_link', short_code=link.short_code) }}" style="display:inline;">
                   <button type="submit" onclick="return confirm('ç¡®å®šè¦åˆ é™¤çŸ­ç  {{ link.short_code }} å—ï¼Ÿè¿™å°†æ— æ³•æ¢å¤ï¼');" style="color:red; background:none; border:none; cursor:pointer; padding:0;">
                      åˆ é™¤
                   </button>
                 </form>
                </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
